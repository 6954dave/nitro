import coda, os

def build(bld):
    includeDir = os.path.join(bld.path.abspath(), os.pardir, 'include')
    module = coda.Module('nitf', moduleDeps='mt sys', uselibLocals='NITRO')
    module.makeLib(bld, includePaths=includeDir)
    
    staticTests = ['test_static_plugin.cpp']
    skipTests = ['test_handles.cpp', 'test_mem_source.cpp'] + staticTests
    module.makeTests(bld, includePaths=includeDir,
                     testFilter=lambda t: t not in skipTests)
    
    #now, make the tests that depend on the static handler plug-in
    module.makeTests(bld, includePaths=includeDir,
                     testFilter=lambda t: t in staticTests,
                     uselib_local='nitf-handlers')
